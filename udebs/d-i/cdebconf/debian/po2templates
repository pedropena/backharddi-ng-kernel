#! /usr/bin/perl

#   This script is called from src/modules/frontend/Makefile
#   to transform PO files (generated by xgettext on regular
#   C files) into debconf templates files.

$/="\n\n";
my $first = 1;
while (<>) {
        s/"\n"//g;
        my ($pre, $name, $descr) = m/(.*)msgid "([^\n]+)"\nmsgid_plural "([^\n]+)"/s;
        print "\n" unless $first;
        $first = 0;
        print "Template: $name\n";
        print "Type: text\n";
        $pre =~ s/^#[,:].*//mg;
        print "# $pre\n" if $pre =~ s/.*#\. ([^\n]+)\n*$/$1/s;
        #$descr = '"'.$descr.'"' if $descr =~ m/\s$/ && $descr !~ m/"/;
        print "_Description: $descr\n";
}
